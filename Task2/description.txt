Map is done per line. Each data on one line is separated by a tabulation. First, I define the limit between two data (line 16). Then I remove all weight equal to 1 (line 18). I reduce each data. Firstly, for each source, I took them as the key and I compute 80% of the associated weight(line 22). Then I took the target as the key and I compute 20% of the associated weight (line 23). Finally I merge all the pairs defined previously (line 24). My key is always the first data of my pair (it can either be a target or a source). For a given key all the associated weights will be added (line 25). Eventually, I format  my output. (line 28)
